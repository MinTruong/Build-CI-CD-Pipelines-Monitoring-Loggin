
# - name: create user and directory
#   become: true
#   shell: |
#     sudo useradd --no-create-home prometheus
#     sudo mkdir /etc/prometheus
#     sudo mkdir /var/lib/prometheus

# - name: install prometheus
#   become: true
#   shell: |
#     wget https://github.com/prometheus/prometheus/releases/download/v2.19.0/prometheus-2.19.0.linux-amd64.tar.gz
#     tar xvfz prometheus-2.19.0.linux-amd64.tar.gz

#     sudo cp prometheus-2.19.0.linux-amd64/prometheus /usr/local/bin
#     sudo cp prometheus-2.19.0.linux-amd64/promtool /usr/local/bin/
#     sudo cp -r prometheus-2.19.0.linux-amd64/consoles /etc/prometheus
#     sudo cp -r prometheus-2.19.0.linux-amd64/console_libraries /etc/prometheus

#     sudo cp prometheus-2.19.0.linux-amd64/promtool /usr/local/bin/
#     rm -rf prometheus-2.19.0.linux-amd64.tar.gz prometheus-2.19.0.linux-amd64

- name: "add prometheus.yml"
  become: true
  copy:
    src: prometheus.yaml
    dest: /etc/prometheus/
    remote_src: yes
    # owner: prometheus
    # group: prometheus        
    # mode: 0777

- name: "add file prometheus.service"
  become: true
  copy:
    src: prometheus.service
    dest: /etc/systemd/system/

- name: start prometheus server
  become: true
  shell: |
    sudo systemctl daemon-reload
    sudo systemctl start prometheus
    sudo systemctl enable prometheus